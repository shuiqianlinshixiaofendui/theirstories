<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>
            场景设置
        </title>
		<style type="text/css">
			html, body{
				margin:0px;
				padding:0px;
				font-size:14px;
				width:80%;
				height:100%;
				margin-left:10%;
			}
			#div_container{
				margin-left:10%;
			}
			#sliderValue{
				float:left;
				width:52px;
			}
			#slider{
				margin-top:-12px;
				margin-left:4px;
			}
			#save{
				margin-left:600px;
			}
		</style>
		<script type="text/javascript" >
			dojoConfig = {
				parseOnLoad: true, 
				packages: [
					{
						name: "spolo",
						location: "/script/spolo"
					},
					{
						name: "scenedetail",
						location: "/modules/scenedetail"
					},
					{
						name: "widgets",
						location: "/widgets"
					}
				]
			};
		</script>
        <script type="text/javascript" src="/libs/dojo/dojo.js"></script>
		 <script type="text/javascript" src="/libs/dojo/dijit.js"></script>
		<link rel="stylesheet" href="/libs/dijit/themes/claro/claro.css"  media="screen"/>
    </head>
    <body class="claro">
		<script type="text/javascript">
			require(
				[
					"dojo/parser","dojo/ready","dojo/dom","dojo/dom-style","dojo/query", "dojo/on", "dijit/form/HorizontalSlider","dijit/form/Button",
					 "dijit/layout/BorderContainer","dijit/layout/ContentPane","dijit/form/TextBox","dijit/form/HorizontalRuleLabels","dijit/form/HorizontalRule",
					 "spolo/data/scene"
					
				],function(
					parser, ready, dom, domStyle,query,on, HorizontalSlider, 
					Button,BorderContainer,ContentPane,TextBox,
					HorizontalRuleLabels,HorizontalRule,scene
				){
					ready(function(){
						var scene = this.parent.scene;
						var iframe = this.parent;
						var slider = new HorizontalSlider({
							name: "horizontalSlider",
							value: 0,
							minimum: 0.001,
							maximum: 100,
							discreteValues:1,
							intermediateChanges: true,
							style: "width:600px;",
							onChange: function(value)
							{
								dom.byId("sliderValue").value = value.toFixed(4);
							}
						}, "slider");
						
						scene.option.getEnvPower
						(
							function(value){
								dom.byId("sliderValue").value = value;
								if(slider)
								{
									slider.set("value",value);
								}
							},
							function(error){
								console.log(error);
							}
						);
						
						var ruleLabels1 = new HorizontalRuleLabels({
							name:"ruleLabels1",
							container:"topDecoration",
							style:"height:1.5em;font-size:75%;color:gray;margin-top:-27px;"
						},"ruleLabels1");
						
						var horizontalRule = new HorizontalRule({
							container:"bottomDecoration",
							count:11,
							style:"height:5px"
						},"horizontalRule");
						
						var ruleLabels1 = new HorizontalRuleLabels({
							name:"ruleLabels1",
							container:"bottomDecoration",
							style:"height:1em;font-size:75%;color:gray;"
						},"ruleLabels2");
						
						//点击保存时调用scene中的option下的set方法
						on(dom.byId("btnSave"),"click",function(){
							var num = dom.byId("sliderValue").value;
							if(!num){
								Spolo.notify({
									"text" : "请先设置环境变量的值!!!",
									"type" : "error",
									"timeout" : 1000
								});
							}
							scene.option.setEnvPower(
								num,
								function(){
									iframe.hideDialog("setSceneDialog");
								},
								function(error){
									console.log(error);
								}
							);
						});
					});
				}
			);
		</script>	
		<div data-dojo-type="dijit/layout/BorderContainer" style="width: 100%; height: 100%;">
			<div data-dojo-type="dijit/layout/ContentPane" data-dojo-props="region:'top'" style="height:100px;">
				<div id="div_container">
					<div>环境设置</div>
					<br />
					<input type="text" id="sliderValue"/>
					<div style="margin-top:17px;">
					<div id="slider">
						<ol id="ruleLabels1">
							<li> </li>
							<li>20</li>
							<li>40</li>
							<li>60</li>
							<li>80</li>
							<li> </li>
						</ol>
					<div id="horizontalRule"></div>
						<ol id="ruleLabels2">
							<li>0</li>
							<li>50</li>
							<li>100</li>
						</ol>
					</div>
					</div>
				</div>
				<div id="save"><button data-dojo-type="dijit/form/Button" id="btnSave">保存</button></div>
			</div>
		</div>
    </body>
</html>