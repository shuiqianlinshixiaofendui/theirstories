<!doctype html>
<html>
<head>
	<meta charset="utf-8" />
	<meta name="description" content=""/>
	<meta name="keywords" content="" />
	<title>二级材质属性编辑页面</title>
</head>
	<script>
		dojoConfig = {
			packages: [
				{
					name: "spolo",
					location: "/script/spolo"
				}
			]
		};
	</script>
	</script>
    <script type="text/javascript" src="/libs/dojo/dojo.js"></script>
	<script type="text/javascript" src="/system/sling.js"></script>
	<script type="text/javascript" src="/script/spolo.js"></script>
	<!--引入css库-->
	<link rel="stylesheet" type="text/css" href="css/main.css" />
	<link rel="stylesheet" type="text/css" href="/libs/dijit/themes/claro/claro.css" /> 	
	<!--实现material的预览-->
	<script>
	
	require(["dojo/ready","spolo/data/resource","dojo/dom-attr","dojo/dom","dojo/dom-style","dojo/html","dojo/on","dojo/mouse","dijit/form/Button","dijit/Dialog","dijit/Tooltip"],function(ready,resource,domAttr,dom,domStyle,html,on,mouse,Button,Dialog,Tooltip){
			ready(function(){
					 dojo.query("body").addClass("claro");
					 // 获得当前节点
					 //var path = Spolo.getCurrentNode();
					 //console.log(path);
						
					 var path="/users/admin/materiallib/defaultCategory/frostedglass";
					 
					 var res = new resource(path);
						console.log(res);
					 var dthis;
					 
					 function onLoaded(material){
					    dthis = material
						domAttr.set(dom.byId("author"),"innerHTML",material.getCreatedBy());
						domAttr.set(dom.byId("mat_name"),"value",material.getName());
						domAttr.set(dom.byId("mat_price"),"value",material.getPrice());
						//日期格式化
						var createdDate = material.getDate();
						//console.log("CreatedDate   " + CreatedDate);
						var year = createdDate.getFullYear();
						var month = createdDate.getMonth() + 1;
						var date = createdDate.getDate();
						var hours = createdDate.getHours();
						var min = createdDate.getMinutes();
						var sec = createdDate.getSeconds();
						var newdate = year + "-" + month + "-" + date + " " + hours + ":" + min + ":" + sec;
						domAttr.set(dom.byId("createdDate"),"innerHTML",newdate);
						domAttr.set(dom.byId("mat_sort"),"value",material.getType());
						domAttr.set(dom.byId("preview"),"src",material.getPreview()); 
						//material.setPrice(10);
						//console.log(material.getPrice());
					 
					 }
					 
					 function onError(error){
						console.log(error);
					 
					 }
					 
					 res.getDetail(onLoaded,onError);
					/*
					res.getDetail(
						function(material){
						//进行测试material.js中的get方法
							console.log(material.getAuthor());
							console.log(material.getUsername());
							console.log(material.getCreatedDate());
							console.log(material.getResouceType());
							console.log(material.getMaterialName());
							console.log(material.getPrice());
							console.log(material.getPreview());
						
						//对input赋值	
						domAttr.set(dojo.byId("author"),"innerHTML",material.getCreatedBy());
						domAttr.set(dojo.byId("mat_name"),"value",material.getName());
						domAttr.set(dojo.byId("mat_price"),"value",material.getPrice());
						domAttr.set(dojo.byId("createdDate"),"innerHTML",material.getDate());
						//domAttr.set(dojo.byId("resType"),"value",material.getResouceType());
						domAttr.set(dojo.byId("preview"),"src",material.getPreview());
						
						},
						function(error){
							console.log(error);
						}
					);
					*/
					dojo.query("#mat_price").on("change", function (object){
						 //console.log("修改价格");
						 //console.log(dthis);
						 //console.log(dthis.getPrice());
						 dthis.setPrice(dom.byId("mat_price").value);	
						 //dthis.setPrice(10)
						 Tooltip.show("修改价格成功！", dom.byId("mat_price"));
					});
					
					dojo.query("#mat_name").on("change", function (object){
						 console.log("修改材质名称");
						 dthis.setName(dom.byId("mat_name").value);
						 Tooltip.show("修改材质名称成功！", dom.byId("mat_name"));
					});
					
					dojo.query("#mat_sort").on("change", function (object){
						 console.log("修改材质类别");	
					});
					
					dojo.query("#uploadpre").on("click", function (object){
						 console.log("修改缩略图");	
					});
					
					dojo.query("#uploadocm").on("click", function (object){
						 console.log("添加二级材质");	
					});
				});
	});
	</script>

<body data-spm="1000859" class="">   
<!-- all-->
<div id="content" class="eshop ark" data-cat="J_Cat">
	<div id="bd">
		<div class="layout grid-s5m0">
			<div class="col-main clearfix">
				<div id="mainwrap" class="main-wrap">
					<div id="detail" class="box">
										  
						<div class="tb-detail-hd">
							<h4>二级材质属性编辑页面</h4>
							<p id="J_EditItem">    </p>
						</div>
							<div id="J_DetailMeta" class="tb-detail-bd tb-clear">
								<div class="tb-summary tb-clear">
									<div class="tb-property">
										<div class="tb-wrap">
											<ul class="tb-meta">
												<li class="tb-detail-price tb-clearfix" id="J_StrPriceModBox">
													<span class="tb-metatit">作者</span><strong id="author" ></strong>
												</li>
												<li class="tb-detail-price tb-clearfix" id="J_StrPriceModBox">
													<span class="tb-metatit">价格</span><input type="text" id="mat_price"></input>&nbsp;&nbsp;<span class="yuan">元</span>
												</li>
												<li class="tb-detail-price tb-clearfix" id="J_StrPriceModBox">
													<span class="tb-metatit">材质名称</span><input type="text" id="mat_name"></input>
												</li>
												<li class="tb-detail-price tb-clearfix" id="J_StrPriceModBox">
													<span class="tb-metatit">材质类别</span><input type="text" id="mat_sort"></input>
												</li>
												<li class="tb-detail-price tb-clearfix" id="J_StrPriceModBox">
													<span class="tb-metatit">上传时间</span><strong id="createdDate" ></strong>
												</li>
											</ul>				                                                          <div class="tb-key">
												<div class="tb-skin tb-naked">
													<div class="tb-sku">    		        		                       			
														<dl id="J_regionSellServer" class="tb-clearfix tb-prop">
														</dl>
														<div class="tb-action tb-clearfix ">
															<div class="tb-btn-basket tb-btn-sku" >
																<a href="#" id="uploadpre">修改缩略图<b></b></a>
															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
									<div class="tb-gallery">						
										<div class="tb-booth tb-pic tb-s310">
											<!--缩略图-->
											<img id="preview" height="310px" width="310px"/>
											</a>
										</div>					
									</div>
								</div>	
							</div>			    				        		    				  
					</div>
																												   <ul id="J_TabBar" class="tabbar clearfix">
						<li class="selected" id="description">
							<a href="#">二级材质详细信息</a>
						</li>
						<li id="uploadocm">
							<a href="#">上传二级材质</a>
						</li>
					</ul>

					<div id="attributes" class="attributes">
						<div class="J_TMDStaticMod"></div>
						<div id="J_Shoppromotions"></div>
						<div class="attributes-list" id="J_AttrList">
							<p class="attr-list-hd clearfix"><em>产品参数：</em></p>
								<ul>
									<li>产品名称：Hisense/海信 LED50K320D...</li>    					
									<li id="J_attrBrandName" >品牌:&nbsp;Hisense/&#28023;&#20449;</li>
									<li>海信3D型号:&nbsp;LED50K320DX3D</li>
									<li>屏幕尺寸:&nbsp;50&#33521;&#23544;</li>
									<li>最佳观看距离:&nbsp;4.0&#31859;(50/52&#33521;&#23544;)</li>
									<li>清晰度:&nbsp;1080p(&#20840;&#39640;&#28165;)</li>
									<li>分辨率:&nbsp;1920&times;1080</li>
									<li>网络连接:&nbsp;&#25903;&#25345;</li>
									<li>HDMI接口:&nbsp;2&#20010;</li>
									<li>面板类型:&nbsp;VA(&#36719;&#23631;)</li>
									<li>3D电视类型:&nbsp;LED&#30005;&#35270;</li>
									<li>3D显示技术:&nbsp;&#20027;&#21160;&#24555;&#38376;&#24335;</li>
									<li >上市时间:&nbsp;2011&#24180;</li>
									<li>屏幕比例:&nbsp;&#23485;&#23631;16:9</li>
									<li>3D电视价格区间:&nbsp;4000-6000&#20803;</li>
									<li>3D电视能效等级:&nbsp;&#19968;&#32423;</li>
									
								</ul>
						</div>
					</div>	
				</div>			
			</div>
		</div>
	</div>		
</div><!--content end-->										
</body>
</html>
