<!DOCTYPE html>
<html lang="zh-CN">
	<head>
		<meta charset="utf-8">
		<title>Glue</title>
		
		<script type="text/javascript">
			var dojoConfig = {
				parseOnLoad: true, 
				packages:[
					{
						name: "widgets",
						location: "/widgets"
					},
					{
						name:"spolo",
						location:"/script/spolo"
					}
					
				]
			};
		</script>
		<script type="text/javascript" src="/libs/dojo/dojo.js"></script>
		<script type="text/javascript" src="/libs/dijit/dijit.js"></script>
		<script type="text/javascript" src="/libs/sling/explorer/js/jquery-1.4.2.min.js"></script>
		<script type="text/javascript" src="./Toolbar.js"></script>
		
		<link rel="stylesheet" href="/libs/dijit/themes/claro/claro.css" media="screen">
		<link rel="stylesheet" href="css/main.css" media="screen">
		<style type="text/css">
			html,body{
				height:100%;
			}
			#testContainer{
				width: 100%; 
				float:left;
				border:1px solid #d1d1d1;
			}
			
		</style>
	</head>
	
	<body class="claro">
		<button id="displayButton">隐藏禁用按钮</button>
		<button id="displayAllButton">隐藏管理员按钮</button>
		<button id="disableButton">禁用按钮</button>
		<button id="nobusyButton">取消忙碌状态</button>
		<!-- <button id="disableAllButton">禁用所有按钮</button> -->
		<div id="testContainer"></div>
		
		<script>
			require(
				[
					"widgets/Toolbar/Toolbar",
					"dojo/on",
					"dijit/Dialog",
					"spolo/data/spsession",
					"dijit/form/Button",
					"dojo/dom-construct",
					"dojo/dom"
				],
				function
				(
				Toolbar, on, Dialog,spsession,Button,domConstruct,dom
				)
				{	
					var displayArr = [
						function(display){
							toolbar.displaySelectAll(display);
						},
						function(display){
							toolbar.displayEditable(display);
						},
						function(display){
							toolbar.displayOptional(display);
						},
						function(display){
							toolbar.displayErasable(display);
						},
						function(display){
							toolbar.displayRenderModel(display);
						},
						function(display){
							toolbar.displayAllRenderModel(display);
						},
						function(display){
							toolbar.displaySearchByPublish(display);
						},
						function(display){
							toolbar.displayMultipleChoice(display);
						}
					];
					var disableArr = [
						function(disable){
							toolbar.disableSelectAll(disable);
						},
						function(disable){
							toolbar.disableEditable(disable);
						},
						function(disable){
							toolbar.disableOptional(disable);
						},
						function(disable){
							toolbar.disableErasable(disable);
						},
						function(disable){
							toolbar.disableRenderModel(disable);
						},
						function(disable){
							toolbar.disableAllRenderModel(disable);
						},
						function(disable){
							toolbar.disableSearchByPublish(disable);
						},
						function(disable){
							toolbar.disableMultipleChoice(disable);
						}
					];
					var config = {
						//isRadio:true //是否打开单选模式。默认为多选。单选模式下禁止全选与取消功能。
						sortable : true, //排序
						gridList : true,//列表视图
						rowList : true,//缩率图视图
						seletAll : true,//全选
						editable : true,    //编辑模式
						optional : true, // 选择模式
						erasable : true, // 删除选中项
						renderModel : true, //渲染模型预览图
						renderAllModel : true,
						searchByPublish : true,
						multipleChoice : true
					}
					//创建List widget对象
					var toolbar = new Toolbar(config);
					var toolbar1 = new Toolbar(config);
					
					//组装list组件
					toolbar.placeAt("testContainer");
					toolbar1.placeAt("testContainer");
					//toolbar.destroyAdminControl();
					function testdisplayAllBtn(){
						toolbar.displayAdminControl(false);
						setTimeout(function(){
							toolbar.displayAdminControl(true);
						},2000);
					}
					
					function testimpl(value,arr,time){
						var index = 0;
						var forTime = 0;
						function xunhuan(){
							if(index<arr.length){
								arr[index](value);
								index++;
								setTimeout(function(){
									if(index<arr.length){
										xunhuan();
									}
									if(index == arr.length){
										if(value == false){
											value = true;
										}else{
											value = false
										}
										
										if(forTime >= time){
											
										}else{
											index=0;
											forTime++;
											xunhuan()
										}
										
									}
								},1000);
							}
						}
							xunhuan();
						
					}
					
					on(dom.byId("displayButton"),"click",function(){
						testimpl(false,displayArr,1);
					});
					on(dom.byId("displayAllButton"),"click",function(){
						testdisplayAllBtn();
					});
					on(dom.byId("disableButton"),"click",function(){
						testimpl(true,disableArr,1);
					});
					on(dom.byId("nobusyButton"),"click",function(){
						toolbar.noBusyRenderModel();
						toolbar.noBusyRenderAllModel();
					});
					
					/**
					*测试用按钮事件
					*/
					
					on(toolbar,"selectAll",function(data){
						alert("全选:"+data);
					});
					on(toolbar,"sortable",function(data){
						console.log({"排序:":data});
					});
					on(toolbar,"gridList",function(data){
						alert("列表视图:"+data);
					});
					on(toolbar,"rowList",function(data){
						alert("缩率图视图:"+data);
					});
					on(toolbar,"editable",function(data){
						alert("编辑模式:"+data);
					});
					on(toolbar,"optional",function(data){
						alert("选择模式:"+data);
					});
					on(toolbar,"erasable",function(){
						alert("删除:");
					});
					on(toolbar,"renderModel",function(){
						alert("渲染模型预览图:");
					});
					on(toolbar,"renderAllModel",function(){
						alert("渲染模型预览图:");
					});
					on(toolbar,"searchByPublish",function(){
						alert("按发布时间搜索:");
					});
					on(toolbar,"multipleChoice",function(){
						alert("全选");
					});
					
					var selectAllBtn = new Button({
						label:"全选",
						onClick:function(){
							alert("全选");
						}
					});
					var editBtn = domConstruct.create("button",{
						innerHTML:"编辑",
						onclick:function(){
							alert("编辑");
						}
					});
					
					toolbar.addMenuItem(selectAllBtn);
					toolbar.addMenuItem(editBtn);
				});
		</script>
	</body>
</html>